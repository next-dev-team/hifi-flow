---
alwaysApply: false
description: 
---
# API Integration Guide

This guide shows how to integrate UI with API using Kubb-generated client/hooks in our React Native (Expo) project.

## Prerequisites

- Node `>= 20.11.0`
- `pnpm` installed (`pnpm@10.22.0`)
- Repo bootstrapped and dependencies installed
- API package: `packages/api-hifi`
- UI App: `apps/native`
- UI Libraries: `heroui-native`, `uniwind` (for styling)
- A React Query provider is configured in `apps/native`

## Integration Scenarios

### 1. Existing API Integration

When the API endpoints already exist in the OpenAPI spec and hooks are generated.

- **Find Hooks**: Check `packages/api-hifi/src/gen/hooks` for available hooks (e.g., `useGetTrackTrackGet`).
- **Import**: `import { useGetTrackTrackGet } from "api-hifi/src/gen/hooks";`
- **Use**: Call the hook in your component and handle `data`, `isLoading`, and `error`.

### 2. Design UI + API Integration

When creating a new feature that requires both UI and API integration.

- **UI Scaffolding**:
  - Create a new screen in `apps/native/app/`.
  - Use `heroui-native` components (`Card`, `Chip`, `Button`).
  - Use `uniwind` for styling: `const StyledView = withUniwind(View);`.
- **API Integration**:
  - Identify the correct hook from `api-hifi`.
  - If the hook doesn't exist, ensure the backend is updated and run `pnpm --filter api-hifi gen:api`.
  - Implement loading and error states using `ActivityIndicator` and error messages.

## Project Structure & Patterns

### Generated Hooks

Generated by Kubb from `https://triton.squid.wtf/openapi.json`:

- Types: `packages/api-hifi/src/gen/types`
- Client: `packages/api-hifi/src/gen/client` (Axios-based)
- Hooks: `packages/api-hifi/src/gen/hooks` (React Query)

### UI Pattern (React Native / Expo)

Each screen or component should:

- Use `withUniwind` for Tailwind-like styling in React Native.
- Use `SafeAreaView` from `react-native-safe-area-context`.
- Use `heroui-native` for high-level UI components.
- Handle API states (loading, error, empty).

Example:

```tsx
import { withUniwind } from "uniwind";
import { View, Text, ActivityIndicator } from "react-native";
import { useGetTrackTrackGet } from "api-hifi/src/gen/hooks";
import { SafeAreaView } from "react-native-safe-area-context";

const StyledSafeAreaView = withUniwind(SafeAreaView);
const StyledText = withUniwind(Text);

export default function TrackDetail({ id }: { id: string }) {
  const { data, isLoading, error } = useGetTrackTrackGet({ id });

  if (isLoading) return <ActivityIndicator />;
  if (error) return <StyledText className="text-red-500">Error loading track</StyledText>;

  return (
    <StyledSafeAreaView className="flex-1 bg-background p-4">
      <StyledText className="text-2xl font-bold">{data?.title}</StyledText>
      {/* Render more data */}
    </StyledSafeAreaView>
  );
}
```

## Manual Workflow

- **Update API**: If backend changes, run `pnpm --filter api-hifi gen:api`.
- **Check Types**: Verify types in `packages/api-hifi/src/gen/types`.
- **Integrate**: Import and use in `apps/native`.

## Verification

- Hooks compile and run without type errors.
- UI renders correctly on mobile (or web via Expo).
- API data is displayed and handles loading/error states gracefully.

## Related

- Kubb config: `packages/api-hifi/kubb.config.ts`
- Generated hooks index: `packages/api-hifi/src/gen/hooks/index.ts`
- UI App: `apps/native`
